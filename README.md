# google-Sheets
Интеграция с Google Таблицами через AppsScript

Скрипт для работы с таблицами на Google Drive


### Инструкция по установке и использованию
#### Более детальную инструкцию, а также шаблон с примерами можете просмотреть [здесь](https://silly-trust-d1f.notion.site/Google-SmartSender-10b552250da380eeb599e2752f88427a)
1. Открыть Google Drive и создать в нем файл AppsScript https://image.mufiksoft.com/chrome_d9l3449qUx
2. Скопировать содержимое файла code.js в созданный файл AppsScript https://image.mufiksoft.com/chrome_72faXiorY0
3. Опубликовать AppsScript как веб-приложение с открытым доступом https://image.mufiksoft.com/chrome_rbhXmVUeul https://image.mufiksoft.com/VcxmgLw0dC
4. При публикации будет запрошен доступ к Вашим данным: Google Drive для чтения в нем файлов; Google Sheets для чтения содержимого таблиц. Предоставьте доступ, чтобы скрипт мог работать с таблицами https://image.mufiksoft.com/chrome_oruqaNEDre (если будет показано окно о том, что Google не проверял данное приложение, то под пунктом дополнительных настроек, можно "всеравно перейти к авторизации" https://image.mufiksoft.com/chrome_lFfmc3f3sd )
5. После публикации скопировать ссылку https://image.mufiksoft.com/chrome_UKkLzgu47g (ее можно проверить в браузере, должен быть ответ, как на скриншоте https://image.mufiksoft.com/chrome_RZ8xUTKAT6 Сама ссылка при этом изменится, это ничего страшного. Использовать нужно именно ту ссылку, которую копировали на предыдущем шаге)
6. В нужном месте воронки добавить блок "Действие" -> "Внешний запрос" с телом запроса, согласно информации о допустимых параметрах ниже https://image.mufiksoft.com/chrome_Cs58dUG5Tn


### Список параметров, воспринимаемых скриптом и необходимых для его работы
1. file - название файла таблицы из Вашего Google Drive (обезательное)
2. sheet - Название листа в Вашей таблице (обезательное)
3. action - выполняемое действие с таблицей (обезательное, доступные варианты значений: read - чтение данных из таблицы; insert - запись новых строк внизу таблицы; update - обновление строки в таблице; remove - удаление строк в таблице; clear - полная очистка таблицы)
4. limit - количество задействованых строк в таблице (для чтения/удаления, по умолчанию - 20)
5. offset - количество пропущеных строк перед задействоваными (для чтения/удаления, по умолчанию - 0)
6. search - фильтры для поиска подходящих строк в формате "Название столбца":"Искомое значение" (обезательное для обновления, поддерживает несколько фильтров одновременно, используется для чтения, обновления, удаления)
7. row - строка для записи в виде масива в формате "Название столбца":"записываемое значение" (обезательное для обновления, условно-обезательное для записи)
8. rows - массив строк (массив елементов row) (Используется для записи нескольких строк. Для записи обезательно наличие row или rows).
9. approvedClear - подтверждение очистки таблицы (обезательное с логическим значением true [значение без кавычек] при использовании action => clear)



### Примечение к скрипту:
Скрипт не делает содержимое ячеек принудительно строкой, что означает, что записываемые данные в таблицу могут быть автоматически распознаны таблицей как число/дата/формула и соответствующе отформатированы. Если Вы хотите избежать форматирования (например записать номер, начинающийся с нулей или телефон, то укажите в самом начале содержимого символ прямого апострофа, например при записи телефона можно указать так: "Телефон":"'{{ phone }}". Также при чтении данных из таблицы, ячейки, отформатированные как дата будут получены в формате ISO 8601, тоесть ячейка с содержимым "19.06.24" будет получена как "2024-06-18T21:00:00.000Z" (19.06.24 00:00:00 с Киевским часовым поясом +3 переведено на часовой пояс по Гринвичу)
